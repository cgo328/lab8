#include "Play.h"
#include <stdio.h>
#include <stdint.h>
#include "../inc/tm4c123gh6pm.h"
#include "SSD2119.h"

const int16_t gravity = 1;		// How much velocity changes when the bird falls
const int16_t jump_vel = -20;		// Upward velocity of bird when it jumps
const int16_t x_pos = 20;		// X position of left edge of bird (stays constant)
const int16_t len = 20;			// Length of bird 
const int16_t height = 15;		// Height of bird

const unsigned short play_bird[] = {
 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0x51C8, 0x51C8,
 0x51C8, 0x51C8, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0x51C8,
 0xFEB2, 0xFEB2, 0xFEB2, 0x51C8, 0xFFDF, 0xFFDF, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
 0x51C8, 0xFEB2, 0xFEB2, 0xF5A8, 0xF5A8, 0x51C8, 0xFFDF, 0xFFDF, 0xFFDF, 0xFFDF, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
 0xFFFF, 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0xF5A8, 0xF5A8, 0xF5A8, 0x51C8, 0xD739, 0xFFDF, 0xFFDF, 0x51C8, 0xFFDF, 0x51C8, 0xFFFF,
 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0xFFDF, 0xFFDF, 0xFFDF, 0xFFDF, 0x51C8, 0xF5A8, 0xF5A8, 0x51C8, 0xD739, 0xFFDF, 0xFFDF, 0x51C8,
 0xFFDF, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0xFFDF, 0xFFDF, 0xFFDF, 0xFFDF, 0xFFDF, 0x51C8, 0xF5A8, 0xF5A8, 0x51C8,
 0xD739, 0xFFDF, 0xFFDF, 0xFFDF, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0xFEB2, 0xFFDF, 0xFFDF, 0xFFDF, 0xFEB2, 0x51C8,
 0xF5A8, 0xF5A8, 0xF5A8, 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0xFEB2, 0xFEB2,
 0xFEB2, 0x51C8, 0xF5A8, 0xF5A8, 0xF5A8, 0x51C8, 0xF9C3, 0xF9C3, 0xF9C3, 0xF9C3, 0xF9C3, 0xF9C3, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF,
 0xFFFF, 0x51C8, 0x51C8, 0x51C8, 0xDC06, 0xDC06, 0xDC06, 0x51C8, 0xF9C3, 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0xFFFF,
 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0xDC06, 0xDC06, 0xDC06, 0xDC06, 0xDC06, 0xDC06, 0x51C8, 0xF9C3, 0xF9C3, 0xF9C3, 0xF9C3,
 0xF9C3, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0x51C8, 0xDC06, 0xDC06, 0xDC06, 0xDC06, 0xDC06, 0x51C8,
 0x51C8, 0x51C8, 0x51C8, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x51C8, 0x51C8, 0x51C8,
 0x51C8, 0x51C8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,

};

int16_t vel;				// Velocity of bird (negative is upward, positive is downward)
int16_t y_pos;				// Y position of top of bird (0 is top of screen)

// Progress the stage 
void advance_stage(void);

// Make flappy bird fall due to gravity
void fall(void) {
	vel += gravity;			// 
	y_pos += vel; 
	LCD_DrawBMP(x_pos, y_pos, play_bird, 19, 15);
}

// Make flappy bird jump if screen is touched
void jump(void) {
	vel = jump_vel;
	y_pos += vel;
	LCD_DrawBMP(x_pos, y_pos, play_bird, 19, 15);
}

// Check to see if flappy bird collided with obstacle (not implemented yet)
uint16_t collision(void) {
	for (int i = 0; i < len; i++) {
	}
	return 0;
}
